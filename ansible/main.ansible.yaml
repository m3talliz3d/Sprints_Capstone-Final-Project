---
- name: Play for deploying jenkins on EC2 instance
  hosts: EC2
#  remote_user: ubuntu
  become: true

  vars:
    ansible_inventory: ./inventory.ini

  tasks:
    - name: Download and install Jenkins keyring
      ansible.builtin.shell: |
        curl -fsSL https://pkg.jenkins.io/debian/jenkins.io.key | sudo tee /usr/share/keyrings/jenkins-keyring.asc > /dev/null &&
        echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] https://pkg.jenkins.io/debian binary/ | sudo tee /etc/apt/sources.list.d/jenkins.list > /dev/null
  
    - name: Update apt
      ansible.builtin.apt:
        update_cache: true

    - name: Install openJDK
      ansible.builtin.apt:
        pkg:
        - openjdk-11-jre
        state: "present"

    - name: Install Jenkins
      ansible.builtin.apt:
        pkg:
        - jenkins
        state: "present"